<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhotoAI - Smart Photo Delivery with Visual Captcha</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
        }
        
        .floating-animation {
            animation: floating 6s ease-in-out infinite;
        }
        
        @keyframes floating {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(1deg); }
            66% { transform: translateY(-10px) rotate(-1deg); }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 40px rgba(255, 255, 255, 0.6);
            }
        }
        
        .slide-in-left {
            animation: slideInLeft 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        @keyframes slideInLeft {
            0% {
                transform: translateX(-100px);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .slide-in-right {
            animation: slideInRight 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        @keyframes slideInRight {
            0% {
                transform: translateX(100px);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .bounce-in {
            animation: bounceIn 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes bounceIn {
            0% {
                transform: scale(0.3);
                opacity: 0;
            }
            50% {
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .zoom-in {
            animation: zoomIn 0.6s ease-out;
        }
        
        @keyframes zoomIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .typewriter {
            overflow: hidden;
            border-right: 3px solid rgba(255, 255, 255, 0.75);
            white-space: nowrap;
            animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
        }
        
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
        
        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: rgba(255, 255, 255, 0.75); }
        }
        
        .camera-preview {
            border-radius: 20px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.4);
            position: relative;
            overflow: hidden;
        }
        
        .camera-preview::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 3s infinite;
            z-index: 1;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .scan-line {
            position: absolute;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #00ff88, #00ff88, transparent);
            animation: scan 2s linear infinite;
            box-shadow: 0 0 10px #00ff88;
        }
        
        @keyframes scan {
            0% { top: 0; opacity: 1; }
            50% { opacity: 0.7; }
            100% { top: 100%; opacity: 1; }
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: particle-float 4s infinite ease-in-out;
        }
        
        @keyframes particle-float {
            0%, 100% { transform: translateY(0px) translateX(0px); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) translateX(20px); opacity: 0; }
        }
        
        .button-hover {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        
        .button-hover::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .button-hover:hover::before {
            left: 100%;
        }
        
        .button-hover:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }
        
        /* Visual Captcha Styles */
        .captcha-canvas {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border: 3px solid #dee2e6;
            position: relative;
            overflow: hidden;
        }
        
        .captcha-canvas::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(0,0,0,0.05) 2px, rgba(0,0,0,0.05) 4px),
                repeating-linear-gradient(-45deg, transparent, transparent 3px, rgba(255,255,255,0.1) 3px, rgba(255,255,255,0.1) 6px);
            pointer-events: none;
        }
        
        .digit-container {
            position: relative;
            display: inline-block;
            margin: 0 6px;
        }
        
        .digit {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 2.5rem;
            color: #2d3748;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            transform: rotate(var(--rotation, 0deg)) scale(var(--scale, 1));
            display: inline-block;
            position: relative;
            z-index: 2;
        }
        
        .noise-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.3;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255,0,0,0.1) 2px, transparent 2px),
                radial-gradient(circle at 80% 70%, rgba(0,255,0,0.1) 1px, transparent 1px),
                radial-gradient(circle at 40% 80%, rgba(0,0,255,0.1) 1px, transparent 1px),
                radial-gradient(circle at 60% 20%, rgba(255,255,0,0.1) 2px, transparent 2px);
            background-size: 50px 50px, 30px 30px, 40px 40px, 60px 60px;
            pointer-events: none;
        }
        
        .distortion-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(0,0,0,0.2), transparent);
            transform: rotate(var(--line-rotation, 0deg));
            animation: lineMove 3s linear infinite;
        }
        
        @keyframes lineMove {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .otp-input {
            transition: all 0.3s ease;
        }
        
        .otp-input:focus {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }
        
        .otp-input.error {
            border-color: #ef4444;
            animation: shake 0.5s ease-in-out;
            background-color: #fef2f2;
        }
        
        .otp-input.success {
            border-color: #10b981;
            background-color: #f0fdf4;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #00ff88, #00d4ff, #ff00ff);
            background-size: 200% 100%;
            animation: progressGlow 2s linear infinite;
        }
        
        @keyframes progressGlow {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .photo-grid-item {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .photo-grid-item:hover {
            transform: scale(1.05) rotate(2deg);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .success-checkmark {
            animation: checkmark 0.6s ease-in-out;
        }
        
        @keyframes checkmark {
            0% {
                transform: scale(0) rotate(45deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(45deg);
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(45deg);
                opacity: 1;
            }
        }
        
        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        .rainbow-border {
            background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
            background-size: 400% 400%;
            animation: rainbow 3s linear infinite;
            padding: 2px;
            border-radius: 20px;
        }
        
        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .sparkle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: sparkle 2s linear infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .refresh-btn {
            transition: all 0.3s ease;
        }
        
        .refresh-btn:hover {
            transform: rotate(180deg) scale(1.1);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen relative">
    <!-- Floating Particles Background -->
    <div class="fixed inset-0 pointer-events-none">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 0.5s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 1.5s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 2.5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 3.5s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 4s;"></div>
    </div>

    <!-- Header -->
    <header class="p-6 relative z-10">
        <div class="max-w-6xl mx-auto flex items-center justify-between slide-in-left">
            <div class="flex items-center space-x-3">
                <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center pulse-glow floating-animation">
                    <span class="text-2xl">📸</span>
                </div>
                <h1 class="text-3xl font-bold text-white typewriter">PhotoAI</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button onclick="toggleAdminMode()" id="adminToggleBtn" class="bg-white/20 text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-all duration-300 text-sm">
                    🔧 Admin Login
                </button>
                <div class="text-white text-sm opacity-80">✨ Smart Photo Delivery with Visual Captcha</div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="max-w-4xl mx-auto px-6 pb-12 relative z-10">
        <!-- Step 1: User Information -->
        <div id="step1" class="glass-effect rounded-3xl p-8 mb-8 bounce-in floating-animation">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold text-white mb-4 zoom-in">Welcome to PhotoAI</h2>
                <p class="text-white opacity-80 slide-in-left">Enter your details to get started with our AI-powered photo delivery service</p>
                <div class="sparkle" style="top: 10%; left: 20%; animation-delay: 0s;"></div>
                <div class="sparkle" style="top: 20%; right: 15%; animation-delay: 0.7s;"></div>
                <div class="sparkle" style="bottom: 15%; left: 30%; animation-delay: 1.4s;"></div>
            </div>
            
            <div class="max-w-md mx-auto space-y-6">
                <div class="slide-in-left" style="animation-delay: 0.2s;">
                    <label class="block text-white font-medium mb-2">Full Name</label>
                    <input type="text" id="userName" class="w-full px-4 py-3 rounded-xl bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 transition-all duration-300 focus:scale-105" placeholder="Enter your full name">
                </div>
                
                <div class="slide-in-right" style="animation-delay: 0.4s;">
                    <label class="block text-white font-medium mb-2">Email Address</label>
                    <input type="email" id="userEmail" class="w-full px-4 py-3 rounded-xl bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 transition-all duration-300 focus:scale-105" placeholder="Enter your email">
                </div>
                
                <div class="slide-in-left" style="animation-delay: 0.6s;">
                    <label class="block text-white font-medium mb-2">Phone Number (10 digits)</label>
                    <input type="tel" id="userPhone" maxlength="10" class="w-full px-4 py-3 rounded-xl bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 transition-all duration-300 focus:scale-105" placeholder="Enter 10-digit phone number" oninput="validatePhoneNumber(this)">
                </div>
                
                <button onclick="sendOTP()" class="w-full bg-white text-purple-600 font-semibold py-3 px-6 rounded-xl button-hover zoom-in" style="animation-delay: 0.8s;">
                    🚀 Continue to Verification
                </button>
            </div>
        </div>

        <!-- Step 2: Visual OTP Captcha -->
        <div id="step2" class="glass-effect rounded-3xl p-8 mb-8 hidden">
            <div class="text-center mb-8">
                <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center pulse-glow">
                    <span class="text-3xl text-white">🔐</span>
                </div>
                <h2 class="text-4xl font-bold text-white mb-4 bounce-in">Visual Security Verification</h2>
                <p class="text-white opacity-80 slide-in-left">Solve the visual captcha to prove you're human</p>
                <div class="sparkle" style="top: 10%; left: 25%; animation-delay: 0s;"></div>
                <div class="sparkle" style="top: 20%; right: 20%; animation-delay: 1s;"></div>
            </div>
            
            <div class="max-w-lg mx-auto">
                <!-- Visual Captcha Canvas -->
                <div class="mb-6">
                    <div class="captcha-canvas rounded-xl p-6 mb-4 relative" style="height: 120px;">
                        <!-- Noise Overlay -->
                        <div class="noise-overlay"></div>
                        
                        <!-- Distortion Lines -->
                        <div class="distortion-line" style="top: 20%; width: 80%; --line-rotation: 15deg;"></div>
                        <div class="distortion-line" style="top: 60%; width: 70%; --line-rotation: -10deg; animation-delay: 1s;"></div>
                        <div class="distortion-line" style="top: 80%; width: 90%; --line-rotation: 5deg; animation-delay: 2s;"></div>
                        
                        <!-- OTP Digits Container -->
                        <div id="otpCanvas" class="flex items-center justify-center h-full relative z-10">
                            <!-- Digits will be generated here -->
                        </div>
                        
                        <!-- Refresh Button -->
                        <button onclick="generateVisualOTP()" class="refresh-btn absolute top-2 right-2 text-gray-600 hover:text-gray-800 p-2 bg-white/50 rounded-full">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <p class="text-white/90 text-center text-sm mb-4">
                        <span class="font-medium">👆 Enter the distorted 6-digit code shown above</span><br>
                        <span class="text-white/70">Look carefully at each number and type what you see</span>
                    </p>
                </div>
                
                <!-- OTP Input Fields -->
                <div class="mb-6">
                    <div class="flex justify-center space-x-3 mb-4 zoom-in">
                        <input type="text" maxlength="1" class="otp-input w-14 h-14 text-center text-xl font-bold bg-white/20 border border-white/30 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                        <input type="text" maxlength="1" class="otp-input w-14 h-14 text-center text-xl font-bold bg-white/20 border border-white/30 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                        <input type="text" maxlength="1" class="otp-input w-14 h-14 text-center text-xl font-bold bg-white/20 border border-white/30 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                        <input type="text" maxlength="1" class="otp-input w-14 h-14 text-center text-xl font-bold bg-white/20 border border-white/30 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                        <input type="text" maxlength="1" class="otp-input w-14 h-14 text-center text-xl font-bold bg-white/20 border border-white/30 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                        <input type="text" maxlength="1" class="otp-input w-14 h-14 text-center text-xl font-bold bg-white/20 border border-white/30 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-white/50">
                    </div>
                </div>
                
                <div class="space-y-3">
                    <button onclick="verifyOTP()" class="w-full bg-white text-purple-600 font-semibold py-3 px-6 rounded-xl button-hover bounce-in">
                        ✅ Verify Captcha
                    </button>
                    
                    <button onclick="generateVisualOTP()" class="w-full bg-white/20 text-white font-medium py-2 px-6 rounded-xl hover:bg-white/30 transition-all duration-300">
                        🔄 Generate New Code
                    </button>
                </div>
                
                <div class="text-center mt-4">
                    <div class="text-white/60 text-xs">
                        💡 Can't read the code? Click refresh to generate a new one
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Photo Capture -->
        <div id="step3" class="glass-effect rounded-3xl p-8 mb-8 hidden">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold text-white mb-4 bounce-in">Capture Your Photo</h2>
                <p class="text-white opacity-80 slide-in-left">Position yourself in the camera frame and take a clear photo</p>
                <div class="sparkle" style="top: 15%; left: 15%; animation-delay: 0s;"></div>
                <div class="sparkle" style="top: 25%; right: 10%; animation-delay: 0.8s;"></div>
                <div class="sparkle" style="bottom: 20%; left: 25%; animation-delay: 1.6s;"></div>
            </div>
            
            <div class="max-w-md mx-auto">
                <div class="relative mb-6 zoom-in">
                    <div class="rainbow-border">
                        <video id="video" class="w-full h-80 object-cover camera-preview bg-black/30" autoplay></video>
                        <canvas id="canvas" class="hidden"></canvas>
                        <div id="capturedPhoto" class="w-full h-80 camera-preview bg-black/30 hidden">
                            <img id="photoPreview" class="w-full h-full object-cover camera-preview">
                        </div>
                    </div>
                </div>
                
                <div class="flex space-x-4 slide-in-left">
                    <button id="captureBtn" onclick="capturePhoto()" class="flex-1 bg-white text-purple-600 font-semibold py-3 px-6 rounded-xl button-hover">
                        📷 Capture Photo
                    </button>
                    <button id="retakeBtn" onclick="retakePhoto()" class="flex-1 bg-red-500 text-white font-semibold py-3 px-6 rounded-xl button-hover hidden">
                        🔄 Retake
                    </button>
                </div>
                
                <button id="processBtn" onclick="processPhoto()" class="w-full mt-4 bg-green-500 text-white font-semibold py-3 px-6 rounded-xl button-hover hidden slide-in-right">
                    🤖 Process with AI
                </button>
            </div>
        </div>

        <!-- Step 4: AI Processing -->
        <div id="step4" class="glass-effect rounded-3xl p-8 mb-8 hidden">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold text-white mb-4 bounce-in">AI Processing</h2>
                <p class="text-white opacity-80 slide-in-left">Our AI is analyzing your photo and finding matching images</p>
                <div class="sparkle" style="top: 10%; left: 20%; animation-delay: 0s;"></div>
                <div class="sparkle" style="top: 30%; right: 15%; animation-delay: 0.5s;"></div>
                <div class="sparkle" style="bottom: 10%; left: 30%; animation-delay: 1s;"></div>
                <div class="sparkle" style="bottom: 25%; right: 25%; animation-delay: 1.5s;"></div>
            </div>
            
            <div class="max-w-md mx-auto">
                <div class="relative mb-6 zoom-in">
                    <div class="w-40 h-40 mx-auto bg-white/20 rounded-full flex items-center justify-center pulse-glow floating-animation">
                        <span class="text-6xl">🤖</span>
                    </div>
                    <div class="scan-line"></div>
                </div>
                
                <div class="text-center slide-in-left">
                    <div class="text-white font-medium mb-2">Processing Status</div>
                    <div class="w-full bg-white/20 rounded-full h-3 mb-4 overflow-hidden">
                        <div id="progressBar" class="progress-bar h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <div id="statusText" class="text-white opacity-80 loading-dots">Initializing AI scan</div>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="glass-effect rounded-3xl p-8 mb-8 hidden">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold text-white mb-4 bounce-in">Admin Panel</h2>
                <p class="text-white opacity-80 slide-in-left">Upload photos to the database for AI matching</p>
                <div class="sparkle" style="top: 10%; left: 20%; animation-delay: 0s;"></div>
                <div class="sparkle" style="top: 20%; right: 15%; animation-delay: 0.7s;"></div>
            </div>
            
            <div class="max-w-2xl mx-auto space-y-6">
                <div class="slide-in-left">
                    <label class="block text-white font-medium mb-2">Upload Photos</label>
                    <input type="file" id="adminPhotos" multiple accept="image/*" class="w-full px-4 py-3 rounded-xl bg-white/20 border border-white/30 text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-white file:text-purple-600 hover:file:bg-gray-100 transition-all duration-300">
                </div>
                
                <div id="uploadedPhotos" class="grid grid-cols-2 md:grid-cols-4 gap-4 hidden">
                    <!-- Uploaded photos will appear here -->
                </div>
                
                <div class="flex space-x-4">
                    <button onclick="uploadPhotos()" class="flex-1 bg-blue-500 text-white font-semibold py-3 px-6 rounded-xl button-hover">
                        📤 Upload to Database
                    </button>
                    <button onclick="showUserPanel()" class="flex-1 bg-green-500 text-white font-semibold py-3 px-6 rounded-xl button-hover">
                        👤 Switch to User Mode
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 5: Results -->
        <div id="step5" class="glass-effect rounded-3xl p-8 hidden">
            <div class="text-center mb-8">
                <div class="success-checkmark w-16 h-16 mx-auto mb-4 bg-green-500 rounded-full flex items-center justify-center">
                    <span class="text-3xl text-white">✓</span>
                </div>
                <h2 class="text-4xl font-bold text-white mb-4 bounce-in">Photos Found!</h2>
                <p class="text-white opacity-80 slide-in-left">We found <span id="photoCount" class="font-bold text-green-300">0</span> photos matching your face</p>
                <div class="sparkle" style="top: 5%; left: 15%; animation-delay: 0s;"></div>
                <div class="sparkle" style="top: 15%; right: 10%; animation-delay: 0.7s;"></div>
                <div class="sparkle" style="bottom: 5%; left: 20%; animation-delay: 1.4s;"></div>
                <div class="sparkle" style="bottom: 15%; right: 20%; animation-delay: 2.1s;"></div>
            </div>
            
            <div id="matchedPhotos" class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8">
                <!-- Matched photos will be displayed here -->
            </div>
            
            <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
                <button onclick="downloadPhotos()" class="flex-1 bg-green-500 text-white font-semibold py-3 px-6 rounded-xl button-hover slide-in-left">
                    📥 Download All Photos
                </button>
                <button onclick="emailPhotos()" class="flex-1 bg-blue-500 text-white font-semibold py-3 px-6 rounded-xl button-hover slide-in-right">
                    📧 Email Photos
                </button>
            </div>
            
            <div class="mt-6 text-center zoom-in" style="animation-delay: 0.8s;">
                <button onclick="startOver()" class="text-white opacity-80 hover:opacity-100 underline transition-all duration-300 hover:scale-105">🔄 Start New Session</button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let stream = null;
        let capturedPhotoData = null;
        let adminMode = false;
        let photoDatabase = []; // Store uploaded photos
        let currentOTP = ''; // Store the current generated OTP

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setupOTPInputs();
        });

        // Phone number validation
        function validatePhoneNumber(input) {
            // Remove any non-digit characters
            input.value = input.value.replace(/\D/g, '');
            
            // Add visual feedback
            if (input.value.length === 10) {
                input.style.borderColor = 'rgba(34, 197, 94, 0.5)';
                input.style.boxShadow = '0 0 20px rgba(34, 197, 94, 0.3)';
            } else {
                input.style.borderColor = 'rgba(255, 255, 255, 0.3)';
                input.style.boxShadow = 'none';
            }
        }

        function sendOTP() {
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;
            const phone = document.getElementById('userPhone').value;
            
            if (!name || !email || !phone) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            if (phone.length !== 10) {
                showNotification('Phone number must be exactly 10 digits', 'error');
                return;
            }
            
            showNotification('Information saved! Please complete the visual captcha.', 'success');
            showStep(2);
            
            // Generate visual OTP after a short delay
            setTimeout(() => {
                generateVisualOTP();
            }, 500);
        }

        // Visual OTP Generation
        function generateVisualOTP() {
            // Generate random 6-digit OTP
            currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
            
            const canvas = document.getElementById('otpCanvas');
            canvas.innerHTML = '';
            
            // Create each digit with random styling
            for (let i = 0; i < 6; i++) {
                const digitContainer = document.createElement('div');
                digitContainer.className = 'digit-container';
                
                const digit = document.createElement('span');
                digit.className = 'digit';
                digit.textContent = currentOTP[i];
                
                // Random rotation and scale for each digit
                const rotation = (Math.random() - 0.5) * 30; // -15 to +15 degrees
                const scale = 0.8 + Math.random() * 0.4; // 0.8 to 1.2
                const hue = Math.random() * 60 + 200; // Blue to purple range
                
                digit.style.setProperty('--rotation', `${rotation}deg`);
                digit.style.setProperty('--scale', scale);
                digit.style.color = `hsl(${hue}, 70%, 40%)`;
                
                // Add random background color
                const bgHue = Math.random() * 360;
                digitContainer.style.background = `hsla(${bgHue}, 30%, 90%, 0.3)`;
                digitContainer.style.borderRadius = '8px';
                digitContainer.style.padding = '4px 8px';
                digitContainer.style.margin = '0 2px';
                
                digitContainer.appendChild(digit);
                canvas.appendChild(digitContainer);
            }
            
            // Add entrance animation
            canvas.style.opacity = '0';
            canvas.style.transform = 'scale(0.8)';
            
            setTimeout(() => {
                canvas.style.transition = 'all 0.5s ease';
                canvas.style.opacity = '1';
                canvas.style.transform = 'scale(1)';
            }, 100);
            
            // Clear input fields
            clearOTPInputs();
            
            console.log('Generated Visual OTP:', currentOTP); // For testing
        }

        // OTP Input handling
        function setupOTPInputs() {
            const otpInputs = document.querySelectorAll('.otp-input');
            otpInputs.forEach((input, index) => {
                input.addEventListener('input', function() {
                    // Remove any non-digit characters
                    this.value = this.value.replace(/\D/g, '');
                    
                    this.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 200);
                    
                    if (this.value.length === 1 && index < otpInputs.length - 1) {
                        otpInputs[index + 1].focus();
                    }
                    
                    // Auto-verify when all fields are filled
                    const allFilled = Array.from(otpInputs).every(inp => inp.value.length === 1);
                    if (allFilled) {
                        setTimeout(verifyOTP, 500);
                    }
                });
                
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Backspace' && this.value === '' && index > 0) {
                        otpInputs[index - 1].focus();
                    }
                });
                
                input.addEventListener('paste', function(e) {
                    e.preventDefault();
                    const pastedData = e.clipboardData.getData('text').replace(/\D/g, '');
                    
                    if (pastedData.length === 6) {
                        otpInputs.forEach((inp, i) => {
                            inp.value = pastedData[i] || '';
                        });
                        setTimeout(verifyOTP, 500);
                    }
                });
            });
        }

        function verifyOTP() {
            const otpInputs = document.querySelectorAll('.otp-input');
            const enteredOTP = Array.from(otpInputs).map(input => input.value).join('');
            
            if (enteredOTP.length !== 6) {
                showNotification('Please enter all 6 digits', 'error');
                return;
            }
            
            if (enteredOTP === currentOTP) {
                // Success
                otpInputs.forEach(input => {
                    input.classList.remove('error');
                    input.classList.add('success');
                });
                
                showNotification('Visual captcha verified successfully!', 'success');
                showStep(3);
                setTimeout(initCamera, 500);
            } else {
                // Error
                otpInputs.forEach(input => {
                    input.classList.remove('success');
                    input.classList.add('error');
                });
                
                showNotification('Incorrect code! Please look carefully and try again.', 'error');
                
                setTimeout(() => {
                    otpInputs.forEach(input => {
                        input.classList.remove('error');
                        input.value = '';
                    });
                    otpInputs[0].focus();
                }, 1500);
            }
        }

        function clearOTPInputs() {
            const inputs = document.querySelectorAll('.otp-input');
            inputs.forEach(input => {
                input.value = '';
                input.classList.remove('error', 'success');
            });
        }

        async function initCamera() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: { ideal: 640 },
                        height: { ideal: 480 },
                        facingMode: 'user'
                    } 
                });
                document.getElementById('video').srcObject = stream;
            } catch (err) {
                console.error('Error accessing camera:', err);
                showNotification('Camera access denied. Please allow camera permissions and refresh the page.', 'error');
            }
        }

        function capturePhoto() {
            const video = document.getElementById('video');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            
            // Add flash effect
            const flash = document.createElement('div');
            flash.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: white;
                z-index: 9999;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.1s;
            `;
            document.body.appendChild(flash);
            
            setTimeout(() => {
                flash.style.opacity = '0.8';
                setTimeout(() => {
                    flash.style.opacity = '0';
                    setTimeout(() => {
                        document.body.removeChild(flash);
                    }, 100);
                }, 100);
            }, 50);
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            
            capturedPhotoData = canvas.toDataURL('image/jpeg');
            
            // Show captured photo with animation
            document.getElementById('photoPreview').src = capturedPhotoData;
            document.getElementById('video').style.display = 'none';
            document.getElementById('capturedPhoto').classList.remove('hidden');
            document.getElementById('capturedPhoto').classList.add('zoom-in');
            document.getElementById('captureBtn').classList.add('hidden');
            document.getElementById('retakeBtn').classList.remove('hidden');
            document.getElementById('processBtn').classList.remove('hidden');
        }

        function retakePhoto() {
            document.getElementById('video').style.display = 'block';
            document.getElementById('capturedPhoto').classList.add('hidden');
            document.getElementById('captureBtn').classList.remove('hidden');
            document.getElementById('retakeBtn').classList.add('hidden');
            document.getElementById('processBtn').classList.add('hidden');
        }

        function processPhoto() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            
            showStep(4);
            simulateAIProcessing();
        }

        function simulateAIProcessing() {
            const progressBar = document.getElementById('progressBar');
            const statusText = document.getElementById('statusText');
            const statuses = [
                'Initializing AI scan',
                'Detecting facial features',
                'Analyzing face structure',
                'Searching photo database',
                'Matching facial patterns',
                'Filtering results',
                'Finalizing matches'
            ];
            
            let progress = 0;
            let statusIndex = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress > 100) progress = 100;
                
                progressBar.style.width = progress + '%';
                
                if (statusIndex < statuses.length - 1 && progress > (statusIndex + 1) * 14) {
                    statusIndex++;
                    statusText.textContent = statuses[statusIndex];
                    statusText.classList.add('bounce-in');
                    setTimeout(() => {
                        statusText.classList.remove('bounce-in');
                    }, 600);
                }
                
                if (progress >= 100) {
                    clearInterval(interval);
                    statusText.textContent = 'Processing complete!';
                    setTimeout(() => {
                        displayMatchedPhotos();
                        showStep(5);
                    }, 1000);
                }
            }, 200);
        }

        // Admin Functions
        function toggleAdminMode() {
            if (!adminMode) {
                showAdminLogin();
            } else {
                adminMode = false;
                document.getElementById('adminToggleBtn').innerHTML = '🔧 Admin Login';
                showUserPanel();
                showNotification('Logged out from admin mode', 'success');
            }
        }

        function showAdminLogin() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="glass-effect rounded-3xl p-8 max-w-md w-full bounce-in">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 mx-auto mb-4 bg-red-500 rounded-full flex items-center justify-center pulse-glow">
                            <span class="text-3xl">🔒</span>
                        </div>
                        <h3 class="text-2xl font-bold text-white mb-2">Admin Access Required</h3>
                        <p class="text-white opacity-80">Enter admin password to continue</p>
                    </div>
                    
                    <div class="space-y-4">
                        <input type="password" id="adminPassword" class="w-full px-4 py-3 rounded-xl bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 transition-all duration-300 focus:scale-105" placeholder="Enter admin password" onkeypress="if(event.key==='Enter') verifyAdminPassword()">
                        
                        <div class="flex space-x-3">
                            <button onclick="verifyAdminPassword()" class="flex-1 bg-green-500 text-white font-semibold py-3 px-6 rounded-xl button-hover">
                                🔓 Login
                            </button>
                            <button onclick="closeAdminLogin()" class="flex-1 bg-red-500 text-white font-semibold py-3 px-6 rounded-xl button-hover">
                                ❌ Cancel
                            </button>
                        </div>
                        
                        <div class="text-center">
                            <p class="text-white/60 text-sm">💡 Hint: Default password is "admin123"</p>
                        </div>
                    </div>
                </div>
            `;
            
            modal.onclick = function(e) {
                if (e.target === modal) closeAdminLogin();
            };
            
            document.body.appendChild(modal);
            
            setTimeout(() => {
                document.getElementById('adminPassword').focus();
            }, 300);
        }

        function verifyAdminPassword() {
            const password = document.getElementById('adminPassword').value;
            const correctPasswords = ['admin123', 'photoai2024', 'secure@123'];
            
            if (correctPasswords.includes(password)) {
                adminMode = true;
                closeAdminLogin();
                hideAllSteps();
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('adminPanel').classList.add('bounce-in');
                document.getElementById('adminToggleBtn').innerHTML = '🚪 Admin Logout';
                showNotification('Admin access granted! Welcome to admin panel.', 'success');
            } else {
                const passwordInput = document.getElementById('adminPassword');
                passwordInput.style.borderColor = 'rgba(239, 68, 68, 0.8)';
                passwordInput.style.animation = 'shake 0.5s ease-in-out';
                passwordInput.value = '';
                
                showNotification('Invalid password! Access denied.', 'error');
                
                setTimeout(() => {
                    passwordInput.style.borderColor = 'rgba(255, 255, 255, 0.3)';
                    passwordInput.style.animation = '';
                }, 500);
            }
        }

        function closeAdminLogin() {
            const modal = document.querySelector('.fixed.inset-0.bg-black\\/80');
            if (modal) {
                modal.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(modal);
                }, 300);
            }
        }

        function showUserPanel() {
            adminMode = false;
            hideAllSteps();
            showStep(1);
        }

        function hideAllSteps() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`step${i}`).classList.add('hidden');
            }
            document.getElementById('adminPanel').classList.add('hidden');
        }

        function uploadPhotos() {
            const fileInput = document.getElementById('adminPhotos');
            const files = fileInput.files;
            
            if (files.length === 0) {
                showNotification('Please select photos to upload', 'error');
                return;
            }
            
            const uploadedPhotosContainer = document.getElementById('uploadedPhotos');
            uploadedPhotosContainer.innerHTML = '';
            uploadedPhotosContainer.classList.remove('hidden');
            
            Array.from(files).forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoData = e.target.result;
                    photoDatabase.push(photoData);
                    
                    const photoElement = document.createElement('div');
                    photoElement.className = 'aspect-square bg-white/20 rounded-xl overflow-hidden photo-grid-item bounce-in';
                    photoElement.style.animationDelay = `${index * 0.1}s`;
                    photoElement.innerHTML = `<img src="${photoData}" class="w-full h-full object-cover">`;
                    
                    uploadedPhotosContainer.appendChild(photoElement);
                };
                reader.readAsDataURL(file);
            });
            
            showNotification(`${files.length} photos uploaded to database successfully!`, 'success');
        }

        function displayMatchedPhotos() {
            const matchedPhotosContainer = document.getElementById('matchedPhotos');
            const photoCountElement = document.getElementById('photoCount');
            
            matchedPhotosContainer.innerHTML = '';
            
            if (photoDatabase.length === 0) {
                // Show placeholder if no photos in database
                for (let i = 0; i < 6; i++) {
                    const photoElement = document.createElement('div');
                    photoElement.className = 'aspect-square bg-white/20 rounded-xl flex items-center justify-center photo-grid-item bounce-in';
                    photoElement.style.animationDelay = `${i * 0.1}s`;
                    photoElement.innerHTML = `<span class="text-4xl">${['📷', '📸', '🖼️'][i % 3]}</span>`;
                    matchedPhotosContainer.appendChild(photoElement);
                }
                photoCountElement.textContent = '6';
            } else {
                // Display actual uploaded photos
                photoDatabase.forEach((photoData, index) => {
                    const photoElement = document.createElement('div');
                    photoElement.className = 'aspect-square bg-white/20 rounded-xl overflow-hidden photo-grid-item bounce-in';
                    photoElement.style.animationDelay = `${index * 0.1}s`;
                    photoElement.innerHTML = `<img src="${photoData}" class="w-full h-full object-cover cursor-pointer" onclick="viewFullPhoto('${photoData}')">`;
                    matchedPhotosContainer.appendChild(photoElement);
                });
                photoCountElement.textContent = photoDatabase.length;
            }
        }

        function viewFullPhoto(photoData) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="max-w-4xl max-h-full">
                    <img src="${photoData}" class="max-w-full max-h-full object-contain rounded-xl">
                    <button onclick="this.parentElement.parentElement.remove()" class="absolute top-4 right-4 bg-white/20 text-white p-2 rounded-full hover:bg-white/30 transition-all duration-300">
                        ✕
                    </button>
                </div>
            `;
            modal.onclick = function(e) {
                if (e.target === modal) modal.remove();
            };
            document.body.appendChild(modal);
        }

        function downloadPhotos() {
            const button = event.target;
            button.style.transform = 'scale(0.95)';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 150);
            
            const link = document.createElement('a');
            link.href = 'data:text/plain;charset=utf-8,Sample Photos Package - PhotoAI\n\nThis is a demo. In a real implementation, this would download a ZIP file containing all matched photos.';
            link.download = 'PhotoAI_Photos.txt';
            link.click();
            
            showNotification('Photos downloaded successfully! Check your downloads folder.', 'success');
        }

        function emailPhotos() {
            const email = document.getElementById('userEmail').value;
            const button = event.target;
            button.style.transform = 'scale(0.95)';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 150);
            
            showNotification(`Photos will be sent to ${email} within 5 minutes!`, 'success');
        }

        function startOver() {
            // Reset all inputs
            document.getElementById('userName').value = '';
            document.getElementById('userEmail').value = '';
            document.getElementById('userPhone').value = '';
            clearOTPInputs();
            
            // Reset OTP
            currentOTP = '';
            
            // Reset camera
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
            
            // Reset photo capture
            document.getElementById('video').style.display = 'block';
            document.getElementById('capturedPhoto').classList.add('hidden');
            document.getElementById('captureBtn').classList.remove('hidden');
            document.getElementById('retakeBtn').classList.add('hidden');
            document.getElementById('processBtn').classList.add('hidden');
            
            showStep(1);
        }

        function showStep(step) {
            // Hide all steps with fade out
            for (let i = 1; i <= 5; i++) {
                const stepElement = document.getElementById(`step${i}`);
                if (!stepElement.classList.contains('hidden')) {
                    stepElement.style.opacity = '0';
                    stepElement.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        stepElement.classList.add('hidden');
                    }, 300);
                }
            }
            
            // Show current step with animation
            setTimeout(() => {
                const currentStepElement = document.getElementById(`step${step}`);
                currentStepElement.classList.remove('hidden');
                currentStepElement.style.opacity = '0';
                currentStepElement.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    currentStepElement.style.transition = 'all 0.5s ease';
                    currentStepElement.style.opacity = '1';
                    currentStepElement.style.transform = 'translateY(0)';
                }, 50);
            }, 300);
            
            currentStep = step;
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-6 right-6 z-50 p-4 rounded-xl text-white font-medium transform translate-x-full transition-all duration-300 ${
                type === 'success' ? 'bg-green-500' : 'bg-red-500'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(full)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Add some interactive sparkles on mouse move
        document.addEventListener('mousemove', function(e) {
            if (Math.random() > 0.98) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = e.clientX + 'px';
                sparkle.style.top = e.clientY + 'px';
                sparkle.style.position = 'fixed';
                sparkle.style.pointerEvents = 'none';
                sparkle.style.zIndex = '1000';
                
                document.body.appendChild(sparkle);
                
                setTimeout(() => {
                    document.body.removeChild(sparkle);
                }, 2000);
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96b3c7d010d09135',t:'MTc1NDUzODMxOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
